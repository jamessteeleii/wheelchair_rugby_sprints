data_long %>%
ggplot(aes(x=time, y=lactate, group=rowid)) +
geom_line() +
stat_summary(geom = "pointrange", fun.data = "mean")
data_long %>%
ggplot(aes(x=time, y=lactate, group=rowid)) +
geom_line() +
stat_summary(geom = "pointrange", fun.data = "mean_se")
data_long %>%
ggplot(aes(x=time, y=lactate)) +
geom_line(aes(group=rowid)) +
stat_summary(geom = "pointrange", fun.data = "mean_se")
?stat_summary
data_long %>%
ggplot(aes(x=time, y=lactate)) +
geom_line(aes(group=rowid)) +
stat_summary(geom = "pointrange", fun.data = "mean_cl_boot")
data_long %>%
ggplot(aes(x=time, y=lactate)) +
geom_line(aes(group=rowid)) +
stat_summary(geom = "pointrange", fun.data = "mean_cl_boot")
data <- pivot_longer(data, cols=4:5,
names_to = "time",
values_to = "lactate") %>%
mutate(time = case_when(
time == "pre" ~ 0,
time == "post" ~ 1
))
brms::brm(lactate ~ disability + time + (1|rowid),
data = data_long)
individual_data_plot <- data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
subtitle = "Individual Data") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
individual_data_plot
model <- brms::brm(lactate ~ disability + time + (1|rowid),
data = data_long)
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1) +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
library(tidybayes)
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1) +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
posterior_epred_draws <- crossing(id = unique(data$id),
disability = unique(data$disability),
distance = unique(data$distance)) %>%
add_epred_draws(model, re_formula = NA)
posterior_epred_draws <- crossing(rowid = unique(data$rowid),
disability = unique(data$disability),
time = unique(data$distance)) %>%
add_epred_draws(model, re_formula = NA)
posterior_epred_draws <- crossing(rowid = unique(data$rowid),
disability = unique(data$disability),
time = unique(data$time)) %>%
add_epred_draws(model, re_formula = NA)
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1) +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
posterior_epred_draws
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1) +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25, position = position_dodge(width = 0.2)) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = 0.2),
size=1, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5,
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
)) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5,
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
posterior_epred_draws <- crossing(rowid = unique(data$rowid),
disability = unique(data$disability),
time = unique(data$time)) %>%
add_epred_draws(model, re_formula = NA) %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post")))
individual_data_plot <- data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5,
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
individual_data_plot
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_nudge(width = 0.2)
size=1.5, scale = 1, side = "left") +
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_nudge(width = 0.2),
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_nudge(x = -0.2),
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = posterior_epred_draws,
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_nudge(x = -0.05),
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(x = time-0.05 y = .epred, color=disability, fill=disability),
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(x = time-0.05, y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
geom_point(aes(y=lactate), size=1, alpha=0.25) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
size=1.5, scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
stat_slabinterval(data = subset(posterior_epred_draws, time == "post"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "right") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(fill = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
stat_slabinterval(data = subset(posterior_epred_draws, time == "post"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "right") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
stat_slabinterval(data = subset(posterior_epred_draws, time == "post"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "right") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
guides(line = "none",
color = "none") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
stat_slabinterval(data = subset(posterior_epred_draws, time == "post"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "right") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
data %>%
mutate(time = case_when(
time == 0 ~ "pre",
time == 1 ~ "post"
),
time = factor(time, levels = c("pre", "post"))) %>%
ggplot(aes(x=time, color=disability)) +
geom_line(aes(y=lactate, group=rowid), size=0.75, alpha=0.5, position = position_dodge(width = -0.05)) +
stat_slabinterval(data = subset(posterior_epred_draws, time == "pre"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "left") +
stat_slabinterval(data = subset(posterior_epred_draws, time == "post"),
aes(y = .epred, color=disability, fill=disability),
.width = .95, alpha = 0.5, position = position_dodge(width = -0.05),
scale = 1, side = "right") +
labs(x="Timepoint",
y=bquote("Blood Lactate (mmol\U00B7"~L^-1~")"),
title = "Global grand mean and 95% credible interval (CI)",
subtitle = "Global grand mean and 95% credible interval (CI)\nIndividual data also shown") +
scale_fill_brewer(palette = "Set2") +
scale_color_brewer(palette = "Dark2") +
theme_classic()
library(patchwork)
individual_data_plot | NA
individual_data_plot |
install.packages("patchwork")
library(patchwork)
(individual_data_plot |  individual_data_plot) + plot_layout(axes = "collect")
library(patchwork)
(individual_data_plot |  individual_data_plot) + plot_layout(axes = "collect")
